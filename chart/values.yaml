# Phasor Helm Chart Values

nameOverride: ""
fullnameOverride: ""

# ServiceAccount configuration
serviceAccount:
  create: true
  automount: false
  name: ""  # Override ServiceAccount name (defaults to release fullname)
  annotations: {}
    # eks.amazonaws.com/role-arn: arn:aws:iam::123456789012:role/phasor

# Backend service configuration
backend:
  replicaCount: 3

  image:
    repository: ghcr.io/monkescience/phasor-backend
    pullPolicy: IfNotPresent
    tag: ""  # Defaults to chart appVersion

  resources:
    requests:
      cpu: 100m
      memory: 128Mi
    limits:
      memory: 128Mi

  config:
#    log_config:
#      level: "info"
#      format: "json"
#      add_source: false

  autoscaling:
    enabled: false
    minReplicas: 2
    maxReplicas: 10
    targetCPUUtilizationPercentage: 80
    targetMemoryUtilizationPercentage: ""
    behavior: {}

  podDisruptionBudget:
    enabled: false
    minAvailable: 1
    # maxUnavailable: 1

  rollout:
    strategy: canary
    smokeTest:
      enabled: true
      replicas: 1
    steps:
      - setWeight: 20
      - pause: { duration: 60s }
      - setWeight: 40
      - pause: { duration: 60s }
      - setWeight: 60
      - pause: { duration: 60s }
      - setWeight: 80
      - pause: { duration: 60s }

# Frontend service configuration
frontend:
  replicaCount: 2

  image:
    repository: ghcr.io/monkescience/phasor-frontend
    pullPolicy: IfNotPresent
    tag: ""  # Defaults to chart appVersion

  resources:
    requests:
      cpu: 100m
      memory: 128Mi
    limits:
      memory: 128Mi

  config:
#    backend_url: "http://phasor-backend/instance/info"
#    log_config:
#      level: "info"
#      format: "json"
#      add_source: false
#    tile_colors:
#      - "#667eea"  # Purple-blue
#      - "#f093fb"  # Pink
#      - "#4facfe"  # Light blue
#      - "#43e97b"  # Green
#      - "#fa709a"  # Rose
#      - "#feca57"  # Yellow
#      - "#ff6348"  # Coral
#      - "#1dd1a1"  # Turquoise

  autoscaling:
    enabled: false
    minReplicas: 2
    maxReplicas: 10
    targetCPUUtilizationPercentage: 80
    targetMemoryUtilizationPercentage: ""
    behavior: {}

  podDisruptionBudget:
    enabled: false
    minAvailable: 1
    # maxUnavailable: 1

  rollout:
    strategy: blueGreen
    blueGreen:
      autoPromotionEnabled: false
      prePromotionAnalysis:
        enabled: true

# NetworkPolicy configuration
networkPolicy:
  enabled: false
  backend:
    additionalIngress: []
    additionalEgress: []
  frontend:
    additionalIngress: []
    additionalEgress: []

# HTTPRoute (Gateway API) configuration
httpRoute:
  enabled: false
  annotations: {}
  parentRefs:
    - name: gateway
      # namespace: gateway-system
      # sectionName: https
  hostnames: []
    # - phasor.example.com
  exposeBackend: false  # Expose backend at /api
